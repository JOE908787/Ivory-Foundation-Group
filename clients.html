<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clients - Ivory Foundation Group</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="logo">Ivory Foundation Group</div>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="services.html">Services</a></li>
                <li><a href="clients.html" class="active">Clients</a></li>
                <li><a href="index.html#contact">Contact</a></li>
            </ul>
        </div>
    </nav>

    <section class="page-header">
        <div class="container">
            <h1>Private Client Portal (Info)</h1>
            <p>This area provides resources and contact options for private clients and partners working with Ivory Foundation Group on portable and permanent housing materials.</p>
        </div>
    </section>

    <section class="content-section">
        <div class="container">
            <h2>Client Login</h2>
            <p>If you are a private client, please log in to access detailed specifications, pricing, and lead times.</p>
            <form id="client-login" class="contact-form">
                <input type="email" id="email" placeholder="Email" required>
                <input type="password" id="password" placeholder="Password" required>
                <button type="submit" class="submit-btn">Login</button>
            </form>
            <div id="login-msg" style="margin-top:1rem;color:#b22222"></div>
            <p style="margin-top:1rem"><a href="#" id="forgot-password-link" style="color:#1a472a;">Forgot Password?</a></p>
            <p style="margin-top:1rem">To request client access, email <a href="mailto:clients@ivoryfoundation.example">clients@ivoryfoundation.example</a>.</p>
        </div>
    </section>

    <!-- Forgot Password Modal -->
    <div id="forgot-password-modal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000;">
        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:white;padding:30px;border-radius:8px;max-width:400px;width:90%;">
            <h3 style="color:#1a472a;margin-top:0;">Request Password Reset</h3>
            <p>Enter your email address and we'll send you a link to reset your password.</p>
            <form id="forgot-password-form">
                <input type="email" placeholder="Email" required style="width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;box-sizing:border-box;margin-bottom:10px;">
                <button type="submit" class="submit-btn" style="margin-bottom:10px;">Send Reset Link</button>
                <button type="button" onclick="document.getElementById('forgot-password-modal').style.display='none';" style="width:100%;padding:10px;background:transparent;border:1px solid #ddd;border-radius:4px;cursor:pointer;">Cancel</button>
            </form>
            <div id="forgot-msg" style="margin-top:1rem;color:#b22222;"></div>
        </div>
    </div>

    <section class="content-section alternate">
        <div class="container">
            <h2>Register as Client</h2>
            <p>To register a new account and request access to client resources, please complete the form below. Your registration will require email verification.</p>
            <form id="client-register" class="contact-form">
                <input type="text" id="reg-name" placeholder="Full Name" required>
                <input type="email" id="reg-email" placeholder="Email" required>
                <input type="password" id="reg-password" placeholder="Password (min 8 characters)" required minlength="8">
                <button type="submit" class="submit-btn">Register</button>
            </form>
            <div id="register-msg" style="margin-top:1rem;color:#b22222"></div>
            <p style="margin-top:1rem;font-size:0.9em;color:#666;">Note: Registration may be disabled. Please contact <a href="mailto:clients@ivoryfoundation.example">clients@ivoryfoundation.example</a> if you cannot register.</p>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 Ivory Foundation Group. All rights reserved.</p>
        </div>
    </footer>

    <script>
    // Login form handler
    document.getElementById('client-login').addEventListener('submit', function(e){
        e.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        fetch('/api/login', {
            method: 'POST',
            headers: {'Content-Type':'application/json'},
            body: JSON.stringify({email, password})
        }).then(r => r.json()).then(data => {
            if (data && data.ok) {
                window.location = '/portal';
            } else {
                document.getElementById('login-msg').textContent = data.error || 'Login failed';
            }
        }).catch(err => document.getElementById('login-msg').textContent = 'Network error');
    });

    // Forgot password modal
    document.getElementById('forgot-password-link').addEventListener('click', function(e){
        e.preventDefault();
        document.getElementById('forgot-password-modal').style.display = 'block';
    });

    document.getElementById('forgot-password-form').addEventListener('submit', function(e){
        e.preventDefault();
        const email = this.querySelector('input[type="email"]').value;
        const btn = this.querySelector('button[type="submit"]');
        btn.disabled = true;
        btn.textContent = 'Sending...';
        
        fetch('/api/request-password-reset', {
            method: 'POST',
            headers: {'Content-Type':'application/json'},
            body: JSON.stringify({email})
        }).then(r => r.json()).then(data => {
            document.getElementById('forgot-msg').textContent = data.message || data.error || 'Request sent';
            document.getElementById('forgot-msg').style.color = data.ok ? '#155724' : '#b22222';
            if (data.ok) {
                setTimeout(() => {
                    document.getElementById('forgot-password-modal').style.display = 'none';
                    this.reset();
                    btn.disabled = false;
                    btn.textContent = 'Send Reset Link';
                }, 3000);
            } else {
                btn.disabled = false;
                btn.textContent = 'Send Reset Link';
            }
        }).catch(err => {
            document.getElementById('forgot-msg').textContent = 'Network error';
            btn.disabled = false;
            btn.textContent = 'Send Reset Link';
        });
    });

    // Registration form handler
    document.getElementById('client-register').addEventListener('submit', function(e){
        e.preventDefault();
        const name = document.getElementById('reg-name').value;
        const email = document.getElementById('reg-email').value;
        const password = document.getElementById('reg-password').value;
        
        fetch('/api/register', {
            method: 'POST',
            headers: {'Content-Type':'application/json'},
            body: JSON.stringify({name, email, password})
        }).then(r => r.json()).then(data => {
            if (data && data.id) {
                document.getElementById('register-msg').style.color = '#155724';
                document.getElementById('register-msg').textContent = data.message || 'Registration successful! Check your email to verify your account.';
                document.getElementById('client-register').reset();
            } else {
                document.getElementById('register-msg').style.color = '#b22222';
                document.getElementById('register-msg').textContent = data.error || 'Registration failed';
            }
        }).catch(err => {
            document.getElementById('register-msg').style.color = '#b22222';
            document.getElementById('register-msg').textContent = 'Network error';
        });
    });
    </script>

    <script src="js/script.js"></script>
</body>
</html>
